@prefix rdf:           <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:          <http://www.w3.org/2000/01/rdf-schema#> .

@prefix sh:            <http://www.w3.org/ns/shacl#> .

@prefix rico:          <https://www.ica.org/standards/RiC/ontology#> .
@prefix ric-rst:       <https://www.ica.org/standards/RiC/vocabularies/recordSetTypes#> .
@prefix ric-dft:       <https://www.ica.org/standards/RiC/vocabularies/documentaryFormTypes#>
@prefix ric-sh:        <https://data.archief.amsterdam/shapes#> .
@prefix xsd:           <http://www.w3.org/2001/XMLSchema#> .

@prefix saa-ont:       <https://data.archief.amsterdam/ontology#> .
@prefix saa-voc:       <https://data.archief.amsterdam/vocabulary#> .

# ARCHIEFINVENTARIS
ric-sh:InventarisShape a sh:NodeShape ;
    sh:targetClass        saa-ont:Inventaris ;
    sh:property [
        sh:message        "Archiefinventaris MUST link to ric-dft:FindingAid with rico:hasDocumentaryFormType" ;
        sh:path           rico:hasDocumentaryFormType ;
        sh:in             ( ric-dft:FindingAid ) ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ];
    sh:property [
        sh:message        "Archiefinventaris MUST link to exactly 1 rico:Title with rico:hasOrHadTitle" ;
        sh:path           rico:hasOrHadTitle ;
        sh:class          rico:Title ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Archiefinventaris CAN link to at most 1 rico:Person or rico:CorporateBody with rico:hasAuthor" ;
        sh:path           rico:hasAuthor ;
        sh:or (
            [ sh:nodeKind       sh:IRI ; ]
            [ sh:class          rico:Person ; ]
            [ sh:class          rico:CorporateBody ; ]
        ) ;
        sh:minCount       0 ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Archiefinventaris MUST link to at exactly 1 rico:CorporateBody with rico:hasPublisher" ;
        sh:path           rico:hasPublisher ;
        sh:or (
            [ sh:nodeKind       sh:IRI ; ]
            [ sh:class          rico:CorporateBody ; ]
        ) ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        # LET OP! Deze moet nog een keer netjes met echte rico:Date's
        sh:message        "Archiefinventaris CAN link to at exactly 1 xsd:date or xsd:gYear with rico:publicationDate" ;
        sh:path           rico:publicationDate ;
        sh:or (
            [ sh:datatype xsd:date ] 
            [ sh:datatype xsd:gYear ] 
        ) ;
        sh:minCount       0 ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Archiefinventaris CAN link to 1 xsd:string or xsd:XMLLiteral with rico:history" ;
        sh:path           rico:history ;
        sh:or (
            [sh:datatype  xsd:string ; ]
            [sh:datatype  rdf:XMLLiteral ; ]
        ) ;
        sh:maxCount       1 ;
    ] .


# ARCHIEF
ric-sh:ArchiefShape a sh:NodeShape ;
    # maps from <https://example.memorix-test.nl/resources/recordtypes/Archiefblok>
    # TODO: zie spreadsheet
    sh:targetClass        saa-ont:Archief ;
    sh:property [
        sh:message        "Archief MUST link to ric-rst:Fonds with rico:hasRecordSetType" ;
        sh:path           rico:hasRecordSetType ;
        sh:in             ( ric-rst:Fonds ) ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ];
    sh:property [
        sh:message        "Archief MUST link at least 1 rico:Identifier with rico:hasOrHadIdentifier" ;
        sh:path           rico:hasOrHadIdentifier ;
        sh:class          rico:Identifier ;
        sh:minCount       1 ;
        # TODO: testen op uniciteit: uniek nummer per type Identifier
        # ISSUE: onderscheid numeriek / alfanumeriek?
    ] ;
    sh:property [
        sh:message        "Archief MUST link to exactly 1 rico:Title with rico:hasOrHadTitle" ;
        sh:path           rico:hasOrHadTitle ;
        sh:class          rico:Title ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Archief MUST link to exactly 1 rico:SingleDate or rico:DateRange with rico:isAssociatedWithDate" ;
        sh:path           rico:isAssociatedWithDate ;
        sh:or (
            [ sh:class          rico:SingleDate ; ]
            [ sh:class          rico:DateRange ; ]
        ) ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Archief MUST link to at most 1 rico:Agent (Archiefbeheerder) with rico:hasOrHadHolder" ;
        sh:path           rico:hasOrHadHolder ;
        sh:or (
            [ sh:nodeKind       sh:IRI ; ]
            [ sh:class          rico:Person ; ]
            [ sh:class          rico:CorporateBody ; ]
            [ sh:class          rico:Family ; ]
        ) ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Archief CAN link to at most 1 rico:Agent (Zorgdrager) with rico:isOrWasUnderAuthorityOf" ;
        sh:path           rico:isOrWasUnderAuthorityOf ;
        sh:or (
            [ sh:nodeKind       sh:IRI ; ]
            [ sh:class          rico:Person ; ]
            [ sh:class          rico:CorporateBody ; ]
            [ sh:class          rico:Family ; ]
        ) ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Archief CAN link to 1 xsd:string or xsd:XMLLiteral with rico:scopeAndContent" ;
        sh:path           rico:scopeAndContent ;
        sh:or (
            [sh:datatype  xsd:string ; ]
            [sh:datatype  rdf:XMLLiteral ; ]
        ) ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Archief CAN link to 1 xsd:string or xsd:XMLLiteral with rico:history" ;
        sh:path           rico:history ;
        sh:or (
            [sh:datatype  xsd:string ; ]
            [sh:datatype  rdf:XMLLiteral ; ]
        ) ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Archief MUST link to at least 1 rico:Agent with rico:hasAccumulator" ;
        sh:path           rico:hasAccumulator ;
        sh:or (
            [ sh:nodeKind       sh:IRI ; ]
            [ sh:class          rico:Person ; ]
            [ sh:class          rico:CorporateBody ; ]
            [ sh:class          rico:Family ; ]
        ) ;
        sh:minCount       1 ;
    ] ;
    sh:property [
        sh:message        "Archief CAN link to 1 or more owl:Thing with rico:hasOrHadSubject" ;
        sh:path           rico:hasOrHadSubject ;
        sh:nodeKind       sh:IRI ;    
    ];
    sh:property [
        sh:message        "Archief MUST link to 1 or more saa-ont:Inventaris with rico:isOrWasDescribedBy" ;
        sh:path           rico:isOrWasDescribedBy ;
        sh:class          saa-ont:Inventaris ;
        sh:minCount       1 ;
    ].

# Verzameling
ric-sh:VerzamelingShape a sh:NodeShape ;
    # maps from <https://example.memorix-test.nl/resources/recordtypes/Verzameling>
    sh:targetClass        saa-ont:Verzameling ;
    sh:property [
        sh:message        "Verzameling MUST link to ric-rst:File with rico:hasRecordSetType" ;
        sh:path           rico:hasRecordSetType ;
        sh:in             ( ric-rst:Series ) ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Verzameling MUST link at least 1 rico:Identifier with rico:hasOrHadIdentifier" ;
        sh:path           rico:hasOrHadIdentifier ;
        sh:class          rico:Identifier ;
        sh:minCount       1 ;
    ] ;
    sh:property [
        sh:message        "Verzameling MUST link to 1 (Verzameling) or 2 (Verzameling en Archief) rico:RecordSet with rico:isOrWasIncludedIn" ;
        sh:path           rico:isOrWasIncludedIn ;
        sh:or (
            [ sh:class saa-ont:Verzameling ] 
            [ sh:class saa-ont:Archief ] 
        ) ;
        sh:minCount       1 ;
        sh:maxCount       2 ;
    ] ;
    sh:property [
        sh:message        "Verzameling MUST link to exactly 1 rico:Title with rico:hasOrHadTitle" ;
        sh:path           rico:hasOrHadTitle ;
        sh:class          rico:Title ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ]; 
    sh:property [
        sh:message        "Verzameling CAN link to at most 1 rico:SingleDate or rico:DateRange with rico:isAssociatedWithDate" ;
        sh:path           rico:isAssociatedWithDate ;
        sh:or (
            [ sh:class          rico:SingleDate ; ]
            [ sh:class          rico:DateRange ; ]
        ) ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Verzameling CAN link to at most 1 xsd:string or xsd:XMLLiteral with rico:scopeAndContent" ;
        sh:path           rico:scopeAndContent ;
        sh:or (
            [sh:datatype  xsd:string ; ]
            [sh:datatype  rdf:XMLLiteral ; ]
        ) ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Verzameling CAN link to at most 1 xsd:string or xsd:XMLLiteral with rico:descriptiveNote" ;
        sh:path           rico:descriptiveNote ;
        sh:or (
            [sh:datatype  xsd:string ; ]
            [sh:datatype  rdf:XMLLiteral ; ]
        ) ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Verzameling CAN link to 1 or more rico:Agent with rico:hasAccumulator" ;
        sh:path           rico:hasAccumulator ;
        sh:or (
            [ sh:nodeKind       sh:IRI ; ]
            [ sh:class          rico:Person ; ]
            [ sh:class          rico:CorporateBody ; ]
            [ sh:class          rico:Family ; ]
        ) ;
    ] ;
    sh:property [
        sh:message        "Verzameling CAN link to 1 or more owl:Thing with rico:hasOrHadSubject" ;
        sh:path           rico:hasOrHadSubject ;
        sh:nodeKind       sh:IRI ;    
    ] .

# BESTANDDEEL
ric-sh:BestanddeelShape a sh:NodeShape ;
    # maps from <https://example.memorix-test.nl/resources/recordtypes/Bestanddeel>
    sh:targetClass        saa-ont:Bestanddeel ;
    sh:property [
        sh:message        "Bestanddeel MUST link to ric-rst:File with rico:hasRecordSetType" ;
        sh:path           rico:hasRecordSetType ;
        sh:in             ( ric-rst:File ) ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Bestanddeel MUST link at least 1 rico:Identifier with rico:hasOrHadIdentifier" ;
        sh:path           rico:hasOrHadIdentifier ;
        sh:class          rico:Identifier ;
        sh:minCount       1 ;
    ] ;
    sh:property [
        sh:message        "Bestanddeel MUST link to 1 (Verzameling) or 2 (Verzameling en Archief) rico:RecordSet with rico:isOrWasIncludedIn" ;
        sh:path           rico:isOrWasIncludedIn ;
        sh:or (
            [ sh:class saa-ont:Verzameling ] 
            [ sh:class saa-ont:Archief ] 
        ) ;
        sh:minCount       1 ;
        sh:maxCount       2 ;
    ] ;
    sh:or ( 
        [
            sh:message        "Bestanddeel MUST link to exactly 1 rico:Title with rico:hasOrHadTitle" ;
            sh:path           rico:hasOrHadTitle ;
            sh:class          rico:Title ;
            sh:minCount       1 ;
            sh:maxCount       1 ;
        ] 
        [
            sh:message        "Bestanddeel MUST link to exactly 1 rico:SingleDate or rico:DateRange with rico:isAssociatedWithDate" ;
            sh:path           rico:isAssociatedWithDate ;
            sh:or (
                [ sh:class          rico:SingleDate ; ]
                [ sh:class          rico:DateRange ; ]
            ) ;
            sh:minCount       1 ;
            sh:maxCount       1 ;
        ] 
    ) ;   
    sh:property [
        sh:message        "Bestanddeel CAN link to at most 1 xsd:string with rico:scopeAndContent" ;
        sh:path           rico:scopeAndContent ;
        sh:or (
            [sh:datatype  xsd:string ; ]
            [sh:datatype  rdf:XMLLiteral ; ]
        ) ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Bestanddeel CAN link to 1 or more rico:Agent with rico:hasAccumulator" ;
        sh:path           rico:hasAccumulator ;
        sh:or (
            [ sh:nodeKind       sh:IRI ; ]
            [ sh:class          rico:Person ; ]
            [ sh:class          rico:CorporateBody ; ]
            [ sh:class          rico:Family ; ]
        ) ;
    ] ;
    sh:property [
        sh:message        "Bestanddeel CAN link to 1 or more owl:Thing with rico:hasOrHadSubject" ;
        sh:path           rico:hasOrHadSubject ;
        sh:nodeKind       sh:IRI ;    
    ] ;
    sh:property [
        sh:message        "Bestanddeel CAN link to 1 or more rico:Instantiation with rico:hasInstantiation" ;
        sh:path           rico:hasOrHadSubject ;
        sh:nodeKind       sh:IRI ;    
    ] .


# INFORMATIEOBJECT
ric-sh:IOShape a sh:NodeShape ;
    # maps from <https://example.memorix-test.nl/resources/recordtypes/Akte>
    # maps from <https://example.memorix-test.nl/resources/recordtypes/Afbeelding>
    sh:targetClass        saa-ont:Informatieobject ;
    sh:property [
        sh:message        "Informatieobject CAN link to at most 1 saa-voc:* with rico:hasDocumentaryFormType" ;
        sh:path           rico:hasDocumentaryFormType ;
        sh:in             ( saa-voc:NotarialDeed saa-voc:BirthCertificate saa-voc:Letter saa-voc:BuildingPermit saa-voc:Machtiging saa-voc:Foto ) ; # etc. etc.
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Informatieobject MUST link at least 1 rico:Identifier with rico:hasOrHadIdentifier" ;
        sh:path           rico:hasOrHadIdentifier ;
        sh:class          rico:Identifier ;
        sh:minCount       1 ;
    ] ;
    sh:property [
        sh:message        "Informatieobject CAN link to at most 1 rico:Title with rico:hasOrHadTitle" ;
        sh:path           rico:hasOrHadTitle ;
        sh:class          rico:Title ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Informatieobject CAN link to at most 1 xsd:string with rico:scopeAndContent" ;
        sh:path           rico:scopeAndContent ;
        sh:or (
            [sh:datatype  xsd:string ; ]
            [sh:datatype  rdf:XMLLiteral ; ]
    ) ;
        sh:maxCount       1 ;
    ] ;    
    sh:property [
        sh:message        "Informatieobject CAN link to at most 1 rico:SingleDate or rico:DateRange with rico:isAssociatedWith" ;
        sh:path           rico:isAssociatedWithDate ;
        sh:or (
            [ sh:class          rico:SingleDate ; ]
            [ sh:class          rico:DateRange ; ]
        ) ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "Informatieobject MUST link to 1 (Bestanddeel) or 2 (Bestanddeel en Archief) rico:RecordSet with rico:isOrWasIncludedIn" ;
        sh:path           rico:isOrWasIncludedIn ;
        sh:or (
            [ sh:class saa-ont:Bestanddeel ] 
            [ sh:class saa-ont:Archief ] 
        ) ;
        sh:minCount       1 ;
        sh:maxCount       2 ;
    ] ;
    sh:property [
        sh:message        "Informatieobject CAN link to 1 or more owl:Thing with rico:hasOrHadSubject" ;
        sh:path           rico:hasOrHadSubject ;
        sh:nodeKind       sh:IRI ;    
    ] .

# ALGEMEEN

## Identifier
ric-sh:IdentifierShape a sh:NodeShape ;
    sh:targetClass        rico:Identifier ;
    sh:property ric-sh:textualValueShape ;
    sh:property [
        sh:message        "rico:Identifier MUST link to exactly 1 rico:IdentifierType with rico:hasIdentifierType" ;
        sh:path           rico:hasIdentifierType ;
        sh:class          rico:IdentifierType ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ] .

ric-sh:IdentifierTypeShape a sh:NodeShape ;
    sh:targetClass        rico:IdentifierType ;
    sh:property [
        sh:message        "rico:IdentifierType MUST link to exactly 1 rico:Name with rico:hasOrHadName" ;
        sh:path           rico:hasOrHadName ;
        sh:class          rico:Name ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ] .

## Title
ric-sh:TitleShape a sh:NodeShape ;
    sh:targetClass  rico:Title ;
    sh:property     ric-sh:textualValueShape .

## Date
ric-sh:DateShape a sh:NodeShape ;
    sh:targetClass        rico:SingleDate ;
    sh:property [
        sh:message        "rico:SingleDate MUST link to exactly 1 xsd:date or xsd:gYear with rico:hasNormalizedDateValue" ;
        sh:path           rico:normalizedDateValue ;
        sh:or (
            [ sh:datatype xsd:date ] 
            [ sh:datatype xsd:gYear ] 
        ) ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "rico:SingleDate CAN link to at most 1 xsd:string with rico:hasNormalizedDateValue" ;
        sh:path           rico:expressedDate ;
        sh:datatype       xsd:string ;
        sh:maxCount       1 ;
    ] .

ric-sh:DateRangeShape a sh:NodeShape ;
    sh:targetClass        rico:DateRange ;
    sh:property [
        sh:message        "rico:DateRange MUST link to at exactly 1 rico:SingleDate with rico:hasBeginningDate" ;
        sh:path           rico:hasBeginningDate ;
        sh:class          rico:SingleDate ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "rico:DateRange MUST link to at exactly 1 rico:SingleDate with rico:hasEndDate" ;
        sh:path           rico:hasEndDate ;
        sh:class          rico:SingleDate ;
        sh:minCount       1 ;
        sh:maxCount       1 ;
    ] ;
    sh:property [
        sh:message        "rico:DateRange CAN link to at most 1 xsd:string with rico:expressedDate" ;
        sh:path           rico:expressedDate ;
        sh:maxCount       1 ;
        sh:datatype       xsd:string ;
    ] .

## Name
ric-sh:NameShape a sh:NodeShape ;
    sh:targetClass  rico:Name, rico:AgentName ;
    sh:property     ric-sh:textualValueShape .

## textualValue
ric-sh:textualValueShape a sh:PropertyShape ;
    sh:message        "This node MUST link to exactly 1 xsd:string with rico:textualValue" ;
    sh:path           rico:textualValue ;
    sh:or (
        [sh:datatype  xsd:string ; ]
        [sh:datatype  rdf:XMLLiteral ; ]
    ) ;
    sh:minCount       1 ;
    sh:minCount       1 .
